<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estadísticas por Color</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>

    <h1>Estadísticas de Intentos, Éxitos y Errores por Color</h1>
    
    <!-- Displaying the bar graph for color statistics -->
    <div id="grafico-colores" style="width:100%;height:400px;"></div>
    <div id="empty-message-colores" style="display:none; color: red;">No hay datos disponibles para mostrar en el gráfico de colores.</div>

    <script>
        // Function to update the bar graph for color statistics
        function actualizarGraficoColores(id_game) {
    console.log("Fetching data for game ID:", id_game);
    $.getJSON(`/color_bar_graph/${id_game}`, function(data) {
        console.log("Data received:", data);
        var graficoColores = document.getElementById('grafico-colores');
        
        // Check if data is available
        if (data && data.data && data.data.length > 0) {
            document.getElementById('empty-message-colores').style.display = 'none';
            Plotly.react(graficoColores, data.data, data.layout);
        } else {
            document.getElementById('empty-message-colores').style.display = 'block';
            Plotly.purge(graficoColores);  // Clear the graph if no data
        }
    }).fail(function() {
        document.getElementById('empty-message-colores').style.display = 'block';
        console.error("Failed to fetch data.");
        Plotly.purge(graficoColores);  // Clear the graph
    });
}
        // Function to get the query parameter from the URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Get the game ID from the URL
        const gameId = getQueryParam('id_game'); // Retrieve the id_game parameter

        // Call the function to update the graph with the retrieved game ID
        if (gameId) {
            actualizarGraficoColores(gameId);
        } else {
            console.error("No game ID provided in the URL.");
        }
    </script>

</body>
</html>
